# 研学行程管理系统

## 项目概述

这是一个用于管理多个研学团组在香港的参访行程安排系统。通过可视化日历界面，让管理员能够灵活安排各团组的参访活动，支持拖拽操作、冲突检测和编辑锁管理。

## 功能特性

### 核心功能
- **团组管理**：添加、编辑、删除研学团组信息
- **地点管理**：管理参访地点，设置容量和限制规则
- **日历视图**：可视化展示行程安排，支持月/周/日视图切换
- **拖拽调整**：直接拖拽活动卡片调整时间安排
- **冲突检测**：自动检测时间冲突、容量超限等问题
- **编辑锁**：单人编辑多人查看，避免并发编辑冲突
- **统计报表**：查看使用统计，导出行程数据

### 数据类型
- **日历详情**：`schedule`

### 技术特性
- **前端**：React + Ant Design + FullCalendar
- **后端**：Node.js + Express
- **认证**：HTTP基础认证
- **数据存储**：内存存储（演示版本）

## 快速开始

### 环境要求
- Node.js 16+ 
- npm 或 yarn

### 安装步骤

1. **克隆项目**
```bash
git clone <项目地址>
cd trip-manager
```

2. **安装后端依赖**
```bash
cd backend
npm install
```

3. **安装前端依赖**
```bash
cd ../frontend  
npm install
```

4. **启动后端服务器**
```bash
cd backend
node simple-server.js
```
后端服务器将运行在 http://localhost:3001

5. **启动前端服务器**
```bash
cd frontend
npm run dev
```
前端服务器将运行在 http://localhost:5173

## 使用指南

### 登录系统
- 访问 http://localhost:5173
- 默认管理员账号：`admin` / `admin123`

### 基本操作流程

1. **查看行程**
   - 默认进入日历视图
   - 可切换月/周/日视图
   - 点击活动查看详情

2. **进入编辑模式**
   - 点击右上角"进入编辑模式"按钮
   - 系统会锁定编辑权限5分钟
   - 自动续期，长时间无操作会自动释放

3. **管理团组**
   - 进入"团组管理"页面
   - 添加团组信息：名称、类型（小学/中学）、人数、开始日期等
   - 可设置团组颜色便于区分

4. **管理地点**
   - 进入"地点管理"页面
   - 设置地点容量、适用团组类型
   - 配置不可用日期（如周三、周四）

5. **安排活动**
   - 在编辑模式下点击日历空白处
   - 选择团组、地点、时间段
   - 系统自动检测冲突并提示

6. **拖拽调整**
   - 在编辑模式下直接拖拽活动卡片
   - 系统实时检测冲突
   - 有冲突时会弹出提示并撤销操作

7. **查看统计**
   - 进入"统计报表"页面
   - 查看地点使用统计
   - 导出活动安排数据

## 默认数据

### 预设地点
1. 香港科学馆（容量200人，周四不可用）
2. 香港警队博物馆（容量100人，仅小学团组）
3. 诺亚方舟（容量150人，周三不可用）
4. 香港海洋公园（容量500人）
5. 西九文化区（容量300人）
6. 香港太空馆（容量100人）
7. 香港大学（容量150人）
8. 驻港部队展览中心（容量100人，仅中学团组）

### 预设团组
1. 深圳实验学校小学部（小学，44人）
2. 广州中学（中学，38人）

## 时间段设置
- **上午**：9:30-11:30
- **下午1**：14:00-15:30  
- **下午2**：16:00-17:30

## 冲突检测规则
1. **时间冲突**：同一团组不能在同一时段安排多个活动
2. **容量限制**：参访地点容量不能超限
3. **日期限制**：检查地点的不可用日期
4. **团组限制**：检查地点是否适用于该类型团组

## 项目结构
```
trip-manager/
├── backend/              # 后端服务
│   ├── simple-server.js  # 简化版服务器
│   └── package.json
├── frontend/             # 前端应用  
│   ├── src/
│   │   ├── components/   # React组件
│   │   ├── pages/        # 页面组件
│   │   ├── services/     # API服务
│   │   └── App.jsx       # 主应用
│   ├── package.json
│   └── vite.config.js
└── README.md
```

## 常见问题

**Q: 为什么无法编辑？**
A: 需要先点击"进入编辑模式"获取编辑权限。

**Q: 编辑模式自动退出了？**
A: 编辑锁默认5分钟超时，系统会自动续期。如果长时间无操作会自动释放。

**Q: 如何解决活动冲突？**
A: 系统会自动检测冲突并提示具体原因，根据提示调整时间或地点即可。

**Q: 数据会保存吗？**
A: 当前为演示版本，数据存储在内存中，重启服务器后会重置。生产版本需要连接数据库。

## 开发说明

这是基于技术方案文档实现的完整研学行程管理系统，包含了所有核心功能。为了快速演示，使用了简化的内存存储方式。

如需部署到生产环境，可参考项目中的完整版本（使用SQLite数据库的版本）。

## 技术支持

如遇问题或需要功能扩展，请联系开发团队。

<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EC Logistics - Excel Mode</title>
    <style>
        :root {
            --bg-app: #f5f5f5;
            --border: #d0d0d0;
            --accent: #1890ff;
            --selection: rgba(24, 144, 255, 0.1);
            --header-bg: #f9f9f9;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, monospace;
            background: var(--bg-app);
            margin: 0; height: 100vh; display: flex; flex-direction: column;
            overflow: hidden; user-select: none; /* Excel-like feel */
        }

        /* Toolbar */
        .excel-toolbar {
            background: #fff; padding: 8px 16px; border-bottom: 1px solid var(--border);
            display: flex; gap: 12px; align-items: center; height: 48px; flex-shrink: 0;
        }
        .btn-tool {
            border: 1px solid transparent; background: transparent; padding: 4px 8px; border-radius: 4px; cursor: pointer; font-size: 13px; color: #333; display: flex; align-items: center; gap: 6px;
        }
        .btn-tool:hover { background: #eee; }
        .btn-primary { background: var(--accent); color: white; padding: 4px 12px; }
        .btn-primary:hover { background: #40a9ff; }
        .separator { width: 1px; height: 20px; background: #ddd; margin: 0 4px; }

        /* The Grid Container */
        .grid-container {
            flex: 1; overflow: auto; background: #fff; position: relative;
        }

        /* The Table */
        .excel-table {
            border-collapse: collapse; min-width: 100%; table-layout: fixed;
        }

        /* Headers */
        .excel-table th {
            background: var(--header-bg); border: 1px solid var(--border);
            padding: 8px; font-weight: 700; font-size: 12px; color: #666; text-align: left;
            position: sticky; top: 0; z-index: 10;
        }
        .excel-table th.col-date { left: 0; z-index: 20; width: 120px; border-right: 2px solid var(--border); }

        /* Cells */
        .excel-table td {
            border: 1px solid var(--border); padding: 0; height: 40px; position: relative;
            background: #fff;
        }
        .excel-table td.col-date {
            position: sticky; left: 0; z-index: 5; background: #fdfdfd;
            border-right: 2px solid var(--border);
            display: flex; align-items: center; justify-content: space-between; padding: 0 8px;
        }

        /* Cell Content */
        .cell-content {
            width: 100%; height: 100%; border: none; outline: none; padding: 8px;
            font-size: 13px; color: #333; background: transparent; display: block;
            box-sizing: border-box;
        }
        
        /* City Input (Small) */
        .city-inp {
            width: 50px; font-size: 11px; text-align: right; border: none; background: transparent; color: var(--accent); font-weight: 600; cursor: pointer; outline: none;
        }

        /* --- THE MAGIC: ACTIVE CELL --- */
        .cell-active {
            outline: 2px solid var(--accent); outline-offset: -2px; z-index: 2;
            background: rgba(255,255,255,1) !important;
        }
        /* The Drag Handle */
        .drag-handle {
            position: absolute; right: -4px; bottom: -4px; width: 8px; height: 8px;
            background: var(--accent); border: 1px solid white; cursor: crosshair;
            display: none; z-index: 3;
        }
        .cell-active .drag-handle { display: block; }

        /* Status Colors */
        .status-conflict { background: #fff1f0; }
        .text-conflict { color: #f5222d; font-weight: 600; }

        /* Meal Columns */
        .col-meal { width: 140px; background: #fbfbfb; } /* Slightly different bg for meals */

    </style>
</head>
<body>

    <div class="excel-toolbar">
        <div style="font-weight:700; margin-right:12px">èµ„æºå¤§è¡¨</div>
        <button class="btn-tool">â†©ï¸ æ’¤é”€</button>
        <button class="btn-tool">â†ªï¸ é‡åš</button>
        <div class="separator"></div>
        <button class="btn-tool">ğŸ“‹ å¤åˆ¶ä¸Šä¸€è¡Œ (Ctrl+D)</button>
        <button class="btn-tool">ğŸ§¹ æ¸…ç©ºé€‰ä¸­</button>
        <div style="flex:1"></div>
        <div style="font-size:12px; color:#999; margin-right:12px">ä¸Šæ¬¡ä¿å­˜: åˆšåˆš</div>
        <button class="btn-tool btn-primary">ä¿å­˜ (Ctrl+S)</button>
    </div>

    <div class="grid-container">
        <table class="excel-table">
            <thead>
                <tr>
                    <th class="col-date">æ—¥æœŸ / åŸå¸‚</th>
                    <th style="width:200px">ğŸ¨ ä½å®¿ (Hotel)</th>
                    <th style="width:200px">ğŸšŒ è½¦è¾† (Vehicle)</th>
                    <th style="width:120px">ğŸš© å¯¼æ¸¸</th>
                    <th class="col-meal">ğŸŒ… æ—©é¤</th>
                    <th class="col-meal">â˜€ï¸ åˆé¤</th>
                    <th class="col-meal">ğŸŒ™ æ™šé¤</th>
                    <th style="width:200px">ğŸ“ å¤‡æ³¨</th>
                </tr>
            </thead>
            <tbody>
                <!-- Row 1 -->
                <tr>
                    <td class="col-date">
                        <span>09-12 (ä¸€)</span>
                        <input class="city-inp" value="é¦™æ¸¯">
                    </td>
                    <td><input class="cell-content" value="ä¸“å®¶å…¬å¯“ Aæ ‹ (20æ ‡)"></td>
                    <td class="status-conflict">
                        <input class="cell-content text-conflict" value="ç‹å¸ˆå‚… (å†²çª!)">
                    </td>
                    <td><input class="cell-content" value="å¼ å°å¯¼"></td>
                    <td class="col-meal"><input class="cell-content" value="è‡ªç†"></td>
                    <td class="col-meal"><input class="cell-content cell-active" value="åŸºåœ°å›´é¤"><div class="drag-handle"></div></td>
                    <td class="col-meal"><input class="cell-content" value="é…’åº—è‡ªåŠ©"></td>
                    <td><input class="cell-content"></td>
                </tr>
                <!-- Row 2 -->
                <tr>
                    <td class="col-date">
                        <span>09-13 (äºŒ)</span>
                        <input class="city-inp" value="é¦™æ¸¯">
                    </td>
                    <td><input class="cell-content" value="ä¸“å®¶å…¬å¯“ Aæ ‹ (20æ ‡)"></td>
                    <td><input class="cell-content" value="æå¸ˆå‚… (ç²¤BÂ·67890)"></td>
                    <td><input class="cell-content" value="å¼ å°å¯¼"></td>
                    <td class="col-meal"><input class="cell-content" value="é…’åº—è‡ªåŠ©"></td>
                    <td class="col-meal"><input class="cell-content" placeholder="è¾“å…¥..."></td>
                    <td class="col-meal"><input class="cell-content" placeholder="è¾“å…¥..."></td>
                    <td><input class="cell-content"></td>
                </tr>
                <!-- Row 3 -->
                <tr>
                    <td class="col-date">
                        <span>09-14 (ä¸‰)</span>
                        <input class="city-inp" value="æ·±åœ³">
                    </td>
                    <td><input class="cell-content" placeholder="è¾“å…¥..."></td>
                    <td><input class="cell-content" placeholder="è¾“å…¥..."></td>
                    <td><input class="cell-content" placeholder="è¾“å…¥..."></td>
                    <td class="col-meal"><input class="cell-content" value="é…’åº—è‡ªåŠ©"></td>
                    <td class="col-meal"><input class="cell-content"></td>
                    <td class="col-meal"><input class="cell-content"></td>
                    <td><input class="cell-content"></td>
                </tr>
                <!-- More Rows -->
                <tr><td class="col-date">09-15 (å››)<input class="city-inp" value="æ·±åœ³"></td><td><input class="cell-content"></td><td><input class="cell-content"></td><td><input class="cell-content"></td><td class="col-meal"><input class="cell-content"></td><td class="col-meal"><input class="cell-content"></td><td class="col-meal"><input class="cell-content"></td><td><input class="cell-content"></td></tr>
                <tr><td class="col-date">09-16 (äº”)<input class="city-inp" value="æ·±åœ³"></td><td><input class="cell-content"></td><td><input class="cell-content"></td><td><input class="cell-content"></td><td class="col-meal"><input class="cell-content"></td><td class="col-meal"><input class="cell-content"></td><td class="col-meal"><input class="cell-content"></td><td><input class="cell-content"></td></tr>
            </tbody>
        </table>
    </div>

</body>
</html>